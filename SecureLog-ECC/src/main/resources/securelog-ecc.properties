# SecureLog ECC 配置文件
# ECC 配置
# ECC 公钥（Base64编码）
# - 用途：用于加密（包裹）组件生成的 SM4 会话密钥，进而保护 SECURE_DATA（敏感明文的加密载荷）
# - 填写内容：SM2 公钥（X.509 SubjectPublicKeyInfo 的 Base64 字符串）
# - 注意：不要带 PEM 头尾（-----BEGIN PUBLIC KEY----- / -----END PUBLIC KEY-----）
ecc.public.key=
# 密码学提供者与算法参数
# ecc.crypto.provider 必须填写 Provider 类名全路径（如 org.bouncycastle.jce.provider.BouncyCastleProvider）
# - 典型场景：使用 BouncyCastle 提供 SM2/SM4 能力
ecc.crypto.provider=org.bouncycastle.jce.provider.BouncyCastleProvider
# SM2 椭圆曲线名称（通常使用国密推荐曲线）
ecc.sm2.curve.name=sm2p256v1
# SM2 非对称加密 Transformation（与 JCE Provider 实现相关）
ecc.sm2.cipher.transformation=SM2
# SM4 对称加密 Transformation（与 JCE Provider 实现相关）
# - 默认：SM4/GCM/NoPadding
# - SECURE_DATA结构（Base64编码前的字节数组；也即对SECURE_DATA做Base64解码后得到的字节数组，当前版本=2）：
#   [version(1)][sm2KeyLen(4)][ivLen(1)][sm2EncryptedSm4Key][iv/nonce][sm4CiphertextAndTag]
#   - version：固定为2
#   - ivLen：IV/nonce长度（GCM推荐12字节；实现会把实际长度写入此字段）
#   - sm2KeyLen：SM2密文长度（4字节大端）
#   - sm2EncryptedSm4Key：SM2加密后的SM4会话密钥
#   - iv/nonce：随机生成，随密文一起存储
#   - sm4CiphertextAndTag：SM4-GCM输出（密文 + 认证标签tag，tag长度由实现决定，默认128bit）
ecc.sm4.cipher.transformation=SM4/GCM/NoPadding
# 脱敏配置（强敏感）
# - 脱敏对象：日志文本中的敏感值 + SECURE_DATA 中保存的原始值（加密存储）
# - 匹配方式：key 命中 + 值形态命中（手机号/身份证/邮箱/地址/高熵 token）
# 强敏感 Key 列表（逗号分隔，大小写不敏感）
# - 既支持：token / access_token / clientSecret 等
# - 也支持：idcard / cardNumber / jbrCardNumber / mobile / phone / email / address 等
ecc.masking.sensitive.keys=password,pwd,pass,token,access_token,clientSecret,secret,apiKey,idcard,cardNumber,jbrCardNumber,mobile,phone,tel,email,address
# token/secret/apiKey 命中后的掩码策略：保留前 N 位
ecc.masking.token.keep.prefix=4
# token/secret/apiKey 命中后的掩码策略：保留后 N 位
ecc.masking.token.keep.suffix=4
# 值形态命中时的最大值长度
# - 目的：避免对大块数据（如 base64 图片、超长 OCR、长 JSON）做扫描/替换导致误伤或性能问题
# - 建议：不超过 50
ecc.masking.max.value.length=50
# 高熵 token / API key 的最小长度（>= 该长度才参与“高熵判断”）
ecc.masking.high.entropy.min.length=20
# 高熵判断阈值（Shannon Entropy）
# - 数值越大越保守（误报更少，漏报更多）
ecc.masking.high.entropy.threshold=3.5
# token-like key 列表（逗号分隔，大小写不敏感）
# - 用途：只有当字段 key 命中该列表时，才会对对应 value 启用“高熵 token”判断
# - 目的：避免把业务ID/UUID/userAgent/URI 等误判为 token
# - 说明：此列表用于“值形态 token”策略，不影响 password/mobile/idcard/email/address 等强敏感 key 的直接脱敏
ecc.masking.tokenlike.keys=token,access_token,clientSecret,secret,apiKey,key,auth,credential
# 是否启用 querystring 识别与脱敏
# - 识别形态：k=v 或 k=v&k2=v2
# - 行为：按 & 拆分为多组 k/v，逐项脱敏后再拼回，尽量不破坏原日志格式
# - 注意：对于不包含 & 的字符串，若疑似 JSON（包含 { 或 :），会跳过 querystring 解析以降低误判
ecc.masking.querystring.enabled=true
# 是否启用“纯文本兜底”扫描
# - 当 JSON/querystring/SQL Parameters 等结构化解析都未命中时，才会启用兜底扫描
# - 当前兜底范围：身份证/手机号/邮箱/严格地址（不会做高熵 token 裸扫）
ecc.masking.fallback.enabled=true
# 严格地址识别（两阶段）开关
# - require.region：必须包含省/市/区/县 等大范围关键字
# - require.detail：必须包含“细节定位”关键字（满足其一即可，关键字由配置项控制）
ecc.masking.address.require.region=true
ecc.masking.address.require.detail=true
# 大范围关键字：用于判定“像地址”的区域信息（逗号分隔）
# - 默认：省,市,区,县
ecc.masking.address.region.keywords=省,市,区,县
# 细节定位关键字：用于判定“像地址”的进一步定位信息（逗号分隔）
# - 默认：街/路/道/巷/镇/乡/号/院/楼/室
# - 如果你的地址描述更多是“办事地点/窗口/大厅”等，直接追加到 detail.keywords 即可
ecc.masking.address.detail.keywords=街,路,道,巷,镇,乡,号,院,楼,室
# 地址误报排除关键字（可选，默认空；逗号分隔）
# - 用途：如果某些非地址文本经常包含 region/detail 关键字导致误报，可在此列出排除词
# - 示例：叫号,序号,编号,文号,公告第,令第
ecc.masking.address.exclude.keywords=
# 是否启用“高熵 token”判断
# - 注意：不会对整行文本裸扫，仅在 tokenlike key / token 参数 场景启用
ecc.masking.high.entropy.enabled=true
# 高熵 token 附加约束：必须同时包含大写字母 + 小写字母 + 数字
# - 目的：进一步降低把业务ID/版本号/路径片段误判为 token 的概率
ecc.masking.high.entropy.require.upper.lower.digit=true
# MDC 配置
# MDC 中存储 SECURE_DATA 的键名
# - SECURE_DATA：用于承载“原始敏感值”加密后的密文（建议只下发到安全日志管道/Graylog/ES 等）
mdc.secure.data.key=SECURE_DATA
# trace_id 在 MDC/ThreadContext 中可能出现的 Key（逗号分隔）
# - 用途：把链路追踪标识与 SECURE_DATA 一起关联，便于审计/回溯
mdc.trace.id.keys=trace_id,traceId,requestId,correlationId,X-Trace-Code,X-Trace-Id
# 密钥缓存管理
# 会话密钥缓存大小
# - 用途：缓存“系统标识符 -> 会话密钥”的映射，避免频繁做非对称运算
ecc.session.key.cache.size=30000
# 会话密钥清理缓冲百分比（0.0-1.0）
# - 达到容量阈值时，按该比例清理旧条目
ecc.session.key.cache.buffer.percentage=0.05
# 系统密钥缓存大小
# - 用途：缓存系统级（或长期）密钥派生/解析结果
ecc.system.key.cache.size=1000
# 系统密钥清理缓冲百分比（0.0-1.0）
ecc.system.key.cache.buffer.percentage=0.1
# 系统标识符变化间隔（分钟）
# - 用途：周期性滚动系统标识符/密钥上下文，降低长期复用带来的风险
ecc.system.id.change.interval.minutes=15
